<!DOCTYPE html>
<html>

<head>
    <title>Date Entry</title>
    <!-- for google integration sign in -->
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="YOUR_CLIENT_ID.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <!-- jQuery -->
    <!-- CSS Style Pages -->
    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <!-- Bootstrap CDN-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Merriweather|Open+Sans" rel="stylesheet">
    <!-- JS script -->
    <!-- Firebase Reference -->
  <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
</head>

<body data-spy="scroll" data-target=".navbar" data-offset="50">

    <br>
    <br>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <ul class="nav navbar-nav navbar-right">
            <li><a href="register.html" role="button" class="btn" data-toggle="modal" data-target="#logIn"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
            <li><a href="login.html"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
            <li id="sign-out"><span id="sign-out" class="glyphicon glyphicon-log-out"></span> Sign-Out</a></li> 
        <!--sign-out Firebase script-->
        <script>    
       document.querySelector('#sign-out').addEventListener('click', function(e) {
       e.preventDefault();
       e.stopPropagation();
       firebase.auth().signOut();
        });
        </script>
         </ul>
        </div>
      </ul>
    </div>
    
    
    
    <div class="modal fade" id="logIn">
        
        
       <div class="container">
            <br>
            <div class="row">
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Log In Authentication</h3>
                        </div>
                        <div class="panel-body">
                            <form id="login-app"></form>
                            <div class="panel-body" ;>
                                <button id="register" style="" onclick="registerUser()" class="mdl-button mdl-js-button mdl-js-ripple-effect btn btn-primary" value="Load new document">Register</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

       

        <!-- Firebase UI Widget-->
        <script src="https://cdn.firebase.com/libs/firebaseui/2.4.0/firebaseui.js"></script>
        <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.4.0/firebaseui.css" />
        <!-- Firebase -->
        <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase.js"></script>
        <!-- Firebase SDK -->
        <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
        <script type="text/javascript">
        var config = {
            apiKey: "AIzaSyAA1EgZPbbAMpIzWeVVtodHCqSjHy-G14c",
            authDomain: "project-1-7c513.firebaseapp.com",
            databaseURL: "https://project-1-7c513.firebaseio.com",
            projectId: "project-1-7c513",
            storageBucket: "project-1-7c513.appspot.com",
            messagingSenderId: "173560237058"
        };

        firebase.initializeApp(config);
        </script>
        <script type="text/javascript">
        var uiConfig = {

            signInSuccessUrl: "index.html",
            signInOptions: [
                firebase.auth.GoogleAuthProvider.PROVIDER_ID,
                firebase.auth.EmailAuthProvider.PROVIDER_ID
            ],
        };

        var ui = new firebaseui.auth.AuthUI(firebase.auth());
        ui.start("#login-app", uiConfig, authCheck);

        var registerUser = function() {
            window.location.replace("register.html");
        };

        var authCheck = function(user) {
            window.user = user;
            var currentUID = null;

            firebase.auth().onAuthStateChanged(function(user) {

                if (user && user.uid != currentUID) {
                    currentUID = user.uid;
                    console.log("Welcome UID:" + currentUID);
                    window.location.assign("index.html")  
                } else {
                    currentUID = null;
                    console.log("no user signed in");
                }
            });

        };
        authCheck();
        </script>
                        

    

    <!-- 
            88b           d88   ,ad8888ba,   88888888ba,        db        88           
            888b         d888  d8"'    `"8b  88      `"8b      d88b       88           
            88`8b       d8'88 d8'        `8b 88        `8b    d8'`8b      88           
            88 `8b     d8' 88 88          88 88         88   d8'  `8b     88           
            88  `8b   d8'  88 88          88 88         88  d8YaaaaY8b    88           
            88   `8b d8'   88 Y8,        ,8P 88         8P d8""""""""8b   88           
            88    `888'    88  Y8a.    .a8P  88      .a8P d8'        `8b  88           
            88     `8'     88   `"Y8888Y"'   88888888Y"' d8'          `8b 88888888888  
     -->
    
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Health Tracker</h4>
                </div>

                <form id="action" id="input-form">
                    
                    <div class="form-group" id="location">
                        <label for="location">Location</label>
                        <input class="form-control" name="location" type="text">
                    </div>
                    
                    <div class="form-group" id="symptoms" name="symptoms">
                        <label for="symptom">Health Symptom Input</label><br>
                         <label class="checkbox-inline symptom">
                            <input type="checkbox" name="respitory" data-toggle="collapse" data-target="#respitory-collapse">Respitory</label>                        <label class="checkbox-inline symptom">
                         <label class="checkbox-inline symptom">
                            <input type="checkbox" name="digestive" data-toggle="collapse" data-target="#digestive-collapse">Digestive</label>
                         <label class="checkbox-inline symptom">
                            <input type="checkbox" name="neurological" data-toggle="collapse" data-target="#neurological-collapse">Neurological</label>
                         <label class="checkbox-inline symptom">
                            <input type="checkbox" name="malaise" data-toggle="collapse" data-target="#malaise-collapse">Malaise</label>
                            <div id="respitory-collapse" class="collapse">HAVE TONS OF INFO ON RESPITORY</div>
                            <div id="digestive-collapse" class="collapse">WANNA KNOW ABOUT DIGESTIVE?! I GOT YOU</div>
                            <div id="neurological-collapse" class="collapse">LOUD NOISES. BRAIN HURTS</div>
                            <div id="malaise-collapse" class="collapse">WHY THE FUCK IS MY FEVER AT 105?!</div>
                    </div>
                    
                    <div class="form-group" id="comments">
                        <label for="comment">Comment (optional): </label><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:#eaa54c" data-toggle="tooltip" title="Add additional information for your eyes only!"></span>
                        <textarea class="form-control" name="comments" rows="5" id="comments"></textarea>
                    </div>
                        
                    <div class="checkbox" id="alcohol">
                        <label>
                            <input type="checkbox" value="" name="alcohol">Alcohol Consumption Today?</label>
                    </div>
                        
                    <div class="form-group" id="activities">
                        <label for="activity">Daily Activity</label>
                            <br>
                        <label class="radio-inline activity">
                            <input type="radio" value="" name="no-exercise">No Exercise</label>
                        <label class="radio-inline activity">
                            <input type="radio" value="" name="light-exercise">Light Exercise</label>
                        <label class="radio-inline activity">
                            <input type="radio" value="" name="mod-exercise">Moderate Exercise</label>
                        <label class="radio-inline activity">

                            <input type="radio" value="" name="heavy-exercise">Heavy Exercise</label>
                     </div>

                    <button type="button" class="btn btn-primary" aria-label="Left Align">
                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span><a href="https://www.fitbit.com/oauth2/authorize?response_type=token&client_id=228M7G&redirect_uri=https%3A%2F%2Fmjoan.github.io%2FProject-1%2Findex.html&scope=activity%20heartrate%20location%20nutrition%20profile%20settings%20sleep%20social%20weight&expires_in=604800"> Sync with your FitBit</a></button>
                    <div class="modal-footer">
                    <button class="btn btn-primary" id="add-user-data-btn" type="submit">Submit</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        
                    </form>
                        
                        
                       
                </div>
            </div>
        </div>
    </div>
  

    
<!-- Calendar -->

 <div id="calendar">

    </div>
<!-- Test Button -->
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Link to Moment.js should go here -->
    <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="vendor/clndr.js"></script>
    <script src="assets/javascript/logic.js"></script>
    <script src="assets/javascript/d3.js"></script>
  
    </script>


      <!-- Script -->

    <script>
      'use strict';
    // fitbit API
        // get the url 
        var url = window.location.href;
        console.log(url);
        //access token from url
        var access_token = url.split("#")[1].split("=")[1].split("&")[0];
        // get userid
        var userId = url.split("#")[1].split("=")[2].split("&")[0];
        $.ajax({
          type: 'GET',
          beforeSend: function(request) {
             request.setRequestHeader("Authorization", 'Bearer ' + access_token);
          },
            url: "https://api.fitbit.com/1/user/"+userId+"/activities/steps/date/today/1w.json",
            success:function(data, status, xhr){
              console.log(JSON.stringify(data));
            }
        });
        $.ajax({
          type: 'GET',
          beforeSend: function(request) {
             request.setRequestHeader("Authorization", 'Bearer ' + access_token);
          },
            url: "https://api.fitbit.com/1/user/"+userId+"/activities/heart/date/today/1w.json",
            success:function(data, status, xhr){
              console.log(JSON.stringify(data));
            }
        });
         $.ajax({
          type: 'GET',
          beforeSend: function(request) {
             request.setRequestHeader("Authorization", 'Bearer ' + access_token);
          },
            url: "https://api.fitbit.com/1/user/"+userId+"/sleep/date/2017-04-02.json",
            success:function(data, status, xhr){
              console.log(JSON.stringify(data.summary.totalMinutesAsleep));
              console.log(JSON.stringify(data.summary.totalTimeInBed));
            }
        });
    // weather API one - grabbing info by user input
        $.ajax({
          url : "https://api.wunderground.com/api/f8b3b3389929c977/history_20170929/q/CA/Los_Angeles.json" ,
          method: "GET"
        })  
        .done(function(response) { 

                           console.log("Max Temp " + JSON.stringify(response.history.dailysummary[0].maxtempi));
               console.log("Min Temp " + JSON.stringify(response.history.dailysummary[0].mintempi));

              console.log("Max Hum " + JSON.stringify(response.history.dailysummary[0].maxhumidity));   
              console.log("Min Hum " + JSON.stringify(response.history.dailysummary[0].minhumidity)); 
              console.log("Mean Wind Speed " + JSON.stringify(response.history.dailysummary[0].meanwindspdi));  
              console.log("Rainfall " + JSON.stringify(response.history.observations[0].rain));    
        });
    // weather API two - grabbing info by user's IP address
    // working link - http://api.wunderground.com/api/f8b3b3389929c977/history_20170929/geolookup/q/autoip.json
        var date = "20170929";
        var weatherQueryURL = "https://api.wunderground.com/api/f8b3b3389929c977/history_" + date + "/geolookup/q/autoip.json";
        $.ajax({
          url : weatherQueryURL,
          method: "GET"
        })  
        .done(function(response) { 

              console.log("Geo Max Temp " + JSON.stringify(response.history.dailysummary[0].maxtempi));
               console.log("Geo Min Temp " + JSON.stringify(response.history.dailysummary[0].mintempi));

              console.log("Geo Max Hum " + JSON.stringify(response.history.dailysummary[0].maxhumidity));   
              console.log("Geo Min Hum " + JSON.stringify(response.history.dailysummary[0].minhumidity)); 
              console.log("Geo Mean Wind Speed " + JSON.stringify(response.history.dailysummary[0].meanwindspdi));  
              console.log("Geo Rainfall " + JSON.stringify(response.history.observations[0].rain));    
        });
    // AQI
        $.ajax({
          url : "https://api.waqi.info/feed/here/?token=593a9ac142943ace1b66178b02174bd1671dd07f",
          method: "GET"
        })  
    // the url above grabs the user's ip's address to determine its location
    // basic url - "http://api.waqi.info/search/?token=593a9ac142943ace1b66178b02174bd1671dd07f&keyword=losangeles"
        .done(function(response) {   
              console.log("AQI " + JSON.stringify(response.data.aqi)); 
    // basic - console.log("AQI " + response.data[0].aqi);  
        });
      </script>
      
</body>

</html>
